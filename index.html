<!DOCTYPE html>
<html lang="hy">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>üéÇ ’ç’∏’Ω’´ ’ø’°÷Ä’•’§’°÷Ä’± üéÇ</title>

  <link rel="icon" type="image/x-icon" href="images/favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="images/favicon-16x16.png">
  <link rel="icon" type="image/png" sizes="32x32" href="images/favicon-32x32.png">
  <link rel="apple-touch-icon" sizes="180x180" href="images/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="192x192" href="images/favicon-192x192.png">
  <link rel="icon" type="image/png" sizes="512x512" href="images/favicon-512x512.png">
  <meta name="theme-color" content="#333333">
  
  <style>
    html, body {
      margin: 0;
      font-family: "Comic Sans MS", cursive, sans-serif;
      background: url("images/background.jpg") no-repeat center center fixed;
      background-size: cover;
      text-align: center;
      color: #333;
      height: 100%;
      overflow-y: auto;
      overflow-x: hidden;
    }

    .card {
      margin: 30px auto;
      background: rgba(102, 102, 102, 0.3);
      border-radius: 20px;
      padding: 30px;
      width: 100%;
      max-width: 500px;
      box-shadow: 0 0 25px rgba(0,0,0,0.3);
      box-sizing: border-box;
      animation: slideUp 1s ease-out;
    }

    @keyframes slideUp {
      from { opacity: 0; transform: translateY(50px); }
      to { opacity: 1; transform: translateY(0); }
    }

    h1 { color: #dbdbdb; font-size: 2em; }
    h3 { color: #fffff0; font-size: 1.3em; }

    input, select, button { font-family: inherit; }

    input {
      width: 88%;
      padding: 10px;
      margin: 10px 0;
      border-radius: 10px;
      border: 1px solid #ccc;
      font-size: 16px;
      background: rgba(255, 255, 255, 0.5);
    }

    select {
      width: 93%;
      padding: 10px;
      margin: 10px 0;
      border-radius: 10px;
      border: 1px solid #ccc;
      font-size: 16px;
      background: rgba(255, 255, 255, 0.5);
    }

    button {
      width: 70%;
      padding: 10px;
      margin: 10px 0;
      border-radius: 10px;
      font-size: 16px;
      background: rgba(0, 0, 0, 0.9);
      color: #fff;
      border: none;
      cursor: pointer;
      font-weight: bold;
      transition: 0.3s;
    }

    button:hover { background: rgba(124, 124, 124, 0.9); }

    ::placeholder { color: #000; }

    .popup {
      display: none;
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.6);
      z-index: 999;
      justify-content: center;
      align-items: center;
    }
    
    .popup-content {
      background: #fff;
      padding: 20px 30px;
      border-radius: 15px;
      text-align: center;
      max-width: 300px;
      width: 80%;
      box-shadow: 0 0 20px rgba(0,0,0,0.3);
      animation: popIn 0.3s ease;
    }
    
    @keyframes popIn {
      from { transform: scale(0.7); opacity: 0; }
      to   { transform: scale(1); opacity: 1; }
    }
    
    .popup-content p { font-size: 1.2em; margin-bottom: 15px; }
    
    .popup-content button {
      padding: 10px 20px;
      border: none;
      border-radius: 8px;
      background: #333;
      color: white;
      font-weight: bold;
      cursor: pointer;
      transition: 0.3s;
      margin: 5px;
    }
    
    .popup-content button:hover { background: #666; }

    #countdown { font-size: 1.3em; color: #fff; margin: 20px 0; }

    #music-btn { display: none; } 

    #confetti-canvas {
      position: fixed;
      bottom: 0; left: 0;
      width: 100%; height: 100%;
      pointer-events: none;
      z-index: 2000;
    }
  </style>
</head>
<body>
  <audio id="bg-music" loop>
    <source src="music/happy_birthday.mp3" type="audio/mpeg">
  </audio>
  <button id="music-btn">üîä ’ä’°÷Ä’•’û’∂÷Ñ</button>
  <canvas id="confetti-canvas"></canvas>

  <div id="popup" class="popup">
    <div class="popup-content">
      <p id="popup-message"></p>
      <button id="add-calendar-btn" style="display:none;">‘±’æ’•’¨’°÷Å’∂’•’¨ ÷Ö÷Ä’°÷Å’∏÷Ç’µ÷Å’∏÷Ç’¥</button>
      <button onclick="closePopup()">’ì’°’Ø’•’¨</button>
    </div>
  </div>

  <div class="card" id="main-card">
    <h1>’Ñ’•’∂÷Ñ ’∑’∏÷Ç’ø’∏’æ 5 ’ø’°÷Ä’•’Ø’°’∂ ’•’∂÷Ñ</h1>
    <p style="color: #fffff0; font-size: 1.2em;">’ç’´÷Ä’∏’æ ’∞÷Ä’°’æ’´÷Ä’∏÷Ç’¥ ’•’∂÷Ñ ’±’•’¶` <br>’¥’°’Ω’∂’°’Ø÷Å’•’¨’∏÷Ç <b>’ç’∏’Ω’´</b> ’Æ’∂’∂’§’µ’°’∂ ÷á ’¥’°’ø’°’≤’´ ’°÷Ä’°÷Ä’∏’≤’∏÷Ç’©’µ’°’∂’® ÷á ’¥’•’¶ ’∞’•’ø ’Ø’´’Ω’•’¨’∏÷Ç ’°’µ’§ ’Ø’°÷Ä÷á’∏÷Ä ’∏÷Ç ’∞’´’∑’°÷Ä’™’°’∂ ÷Ö÷Ä’®</p>
    <p style="color: #fffff0; font-size: 1.2em;">’ç’´÷Ä’∏’æ ’Ø’Ω’∫’°’Ω’•’∂÷Ñ ’±’•’¶’ù <br><span style="text-align: center;"><b>üìÖ 27 ’Ü’∏’µ’•’¥’¢’•÷Ä’´ 2025<br>üìç ‘ø’´’¨’´’Ø’´’∏ ’£’°÷Ä’§’•’∂ <br>üïï ‘∫’°’¥’® 18:00</span></b></p>
    <p id="countdown"></p>
    <p><a href="https://yandex.com/maps/-/CLBII2kZ" style="color: #fffff0; font-size: 1.2em;"><b>‘ª’∂’π’∫’•’û’Ω ’∞’°’Ω’∂’•’¨</b></a></p>
    <h3 style="font-style: normal;">‘Ω’∂’§÷Ä’∏÷Ç’¥ ’•’∂÷Ñ ’∞’°’Ω’ø’°’ø’•’¨ ’±’•÷Ä ’∞÷Ä’°’æ’•÷Ä’® ’Ω’ø’∏÷Ä÷á</h3>
    <form id="rsvpForm">
      <input type="text" id="name" placeholder="‘±’∂’∏÷Ç’∂ ’°’¶’£’°’∂’∏÷Ç’∂ *"><br>
      <input type="tel" id="phone" placeholder="’Ä’•’º’°’≠’∏’Ω’°’∞’°’¥’°÷Ä *" inputmode="tel"><br>
      <input type="number" id="count" placeholder="‘±’∂’±’°’∂÷Å ÷Ñ’°’∂’°’Ø *" inputmode="numeric" min="1"><br>
      <select id="status">
        <option value="" disabled selected hidden>‘∏’∂’ø÷Ä’•’¨ *</option>
        <option value="‘±’µ’∏">’Ñ’•’Æ ’Ω’´÷Ä’∏’æ</option>
        <option value="’à’π">’ë’°’æ’∏÷Ñ ’∏’π</option>
      </select><br>
      <button type="submit">’Ä’°’Ω’ø’°’ø’•’¨</button>
    </form>

    <p id="response"></p>
  </div>

<script>
const music = document.getElementById("bg-music");

// –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ –º—É–∑—ã–∫–∏
function tryPlayMusic() { music.play().catch(() => {}); }
["click", "touchstart", "input", "scroll"].forEach(evt => {
  window.addEventListener(evt, tryPlayMusic, { once: true });
});
window.addEventListener("load", () => { setTimeout(() => { music.play().catch(() => {}); }, 800); });

// –¢–∞–π–º–µ—Ä –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –æ—Ç—Å—á—ë—Ç–∞
function startCountdown() {
  const targetDate = new Date("2025-11-27T18:00:00");
  const countdownEl = document.getElementById("countdown");
  function updateCountdown() {
    const now = new Date();
    const diff = targetDate - now;
    if(diff<=0){ countdownEl.innerHTML="üéâ ’è’∏’∂’°’Ø’°’ø’°÷Ä’∏÷Ç’©’µ’∏÷Ç’∂’® ’Ω’Ø’Ω’æ’•’¨ ’ß üéâ"; return; }
    const days=Math.floor(diff/(1000*60*60*24));
    const hours=Math.floor((diff/(1000*60*60))%24);
    const minutes=Math.floor((diff/(1000*60))%60);
    const seconds=Math.floor((diff/1000)%60);
    countdownEl.innerHTML=`’Ñ’∂’°÷Å’•’¨ ’ß’ù <b>${days}</b> ÷Ö÷Ä <b>${hours}</b> ’™’°’¥ <b>${minutes}</b> ÷Ä’∏’∫’• <b>${seconds}</b> ’æ’°’µ÷Ä’Ø’µ’°’∂`;
  }
  updateCountdown();
  setInterval(updateCountdown,1000);
}
startCountdown();

// –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–æ—Ä–º—ã
document.getElementById("rsvpForm").addEventListener("submit", function(e){
  e.preventDefault();
  const name = document.getElementById("name").value.trim();
  const phone = document.getElementById("phone").value.trim();
  const count = document.getElementById("count").value.trim();
  const status = document.getElementById("status").value;

  if(!name || !phone || !count || !status){
    showPopup("‘Ω’∂’§÷Ä’∏÷Ç’¥ ’•’∂÷Ñ ’¨÷Ä’°÷Å’∂’•’¨ ’¢’∏’¨’∏÷Ä ’∫’°÷Ä’ø’°’§’´÷Ä ’∂’∑’æ’°’Æ ’§’°’∑’ø’•÷Ä’®÷â");
    return;
  }

  fetch("https://sheetdb.io/api/v1/73phymm5nctlc", {
    method:"POST",
    body:JSON.stringify({ data:[{ name, phone, count, status }] }),
    headers: { "Content-Type":"application/json" }
  })
  .then(res=>res.json())
  .then(()=>{
    const popupMessage = `’Ä’°÷Ä’£’•’¨’´ <b>${name}</b>, ’§’∏÷Ç÷Ñ ’∞’°’ª’∏’≤’∏÷Ç’©’µ’°’¥’¢ ’£÷Ä’°’∂÷Å’æ’•÷Å’´÷Ñ`;
    showPopup(popupMessage);

    // –ü–æ–∫–∞–∑–∞—Ç—å –∫–Ω–æ–ø–∫—É –∫–∞–ª–µ–Ω–¥–∞—Ä—è
    const calendarBtn = document.getElementById("add-calendar-btn");
    calendarBtn.style.display = "inline-block";

    calendarBtn.onclick = () => {
      const eventTitle = "’ç’∏’Ω’´ 5-’°’¥’µ’°’Ø’´ ‘æ’∂’∂’§’µ’°’∂ ’Ä÷Ä’°’æ’•÷Ä";
      const eventLocation = "‘ø’´’¨’´’Ø’´’∏ ’£’°÷Ä’§’•’∂";
      const eventDescription = "’Ñ’°’Ω’∂’°’Ø÷Å’•’¨ ’ç’∏’Ω’´ ’Æ’∂’∂’§’µ’°’∂ ÷á ’¥’°’ø’°’≤’´ ’°÷Ä’°÷Ä’∏’≤’∏÷Ç’©’µ’°’∂’®";
      
      const start = new Date("2025-11-27T18:00:00");
      const end = new Date("2025-11-27T23:30:00");
      
      function formatDateForICS(date) {
        const pad = n => n.toString().padStart(2,'0');
        return date.getFullYear() +
               pad(date.getMonth()+1) +
               pad(date.getDate()) +
               "T" +
               pad(date.getHours()) +
               pad(date.getMinutes()) +
               pad(date.getSeconds());
      }

      const startDate = formatDateForICS(start);
      const endDate = formatDateForICS(end);
      const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);

      if(isMobile){
        const icsContent = `
        BEGIN:VCALENDAR
        VERSION:2.0
        BEGIN:VEVENT
        SUMMARY:${eventTitle}
        DTSTART:${startDate}
        DTEND:${endDate}
        LOCATION:${eventLocation}
        DESCRIPTION:${eventDescription}
        END:VEVENT
        END:VCALENDAR`.trim();

        const encodedUri = encodeURI("data:text/calendar;charset=utf8," + icsContent);
        window.open(encodedUri, "_blank");
      } else {
        const googleUrl = `https://www.google.com/calendar/render?action=TEMPLATE&text=${encodeURIComponent(eventTitle)}&dates=${startDate}/${endDate}&details=${encodeURIComponent(eventDescription)}&location=${encodeURIComponent(eventLocation)}&sf=true&output=xml`;
        window.open(googleUrl, "_blank");
      }
    };

    document.getElementById("rsvpForm").reset();
  })
  .catch(()=>{
    showPopup(`’Ä’°÷Ä’£’•’¨’´ <b>${name}</b>, ’£÷Ä’°’∂÷Å’æ’•’¨’∏÷Ç ’®’∂’©’°÷Å÷Ñ’∏÷Ç’¥ ’°’º’°’ª’°÷Å’•’¨ ’ß ’≠’∂’§’´÷Ä, ’≠’∂’§÷Ä’∏÷Ç’¥ ’•’∂÷Ñ ÷É’∏÷Ä’±’•÷Ñ ’Ø÷Ä’Ø’´’∂`);
  });
});

// –ö–æ–Ω—Ñ–µ—Ç—Ç–∏
function celebrate() {
  const canvas=document.getElementById("confetti-canvas");
  const ctx=canvas.getContext("2d");
  const confetti=[];
  canvas.width=window.innerWidth; canvas.height=window.innerHeight;
  const shapes=["circle","square","triangle","ribbon"];
  let opacity=1.0;
  for(let i=0;i<180;i++){
    confetti.push({
      x:Math.random()*canvas.width,
      y:Math.random()*-canvas.height,
      r:Math.random()*6+4,
      d:Math.random()*0.5+0.5,
      color:`hsl(${Math.random()*360},100%,60%)`,
      tilt:Math.random()*10-5,
      tiltAngle:0,
      tiltAngleIncrement:Math.random()*0.07+0.02,
      shape:shapes[Math.floor(Math.random()*shapes.length)],
      rotation:Math.random()*360,
      rotationSpeed:Math.random()*5-2.5
    });
  }
  function draw(c){
    ctx.save(); ctx.translate(c.x,c.y); ctx.rotate(c.rotation*Math.PI/180);
    ctx.globalAlpha=opacity; ctx.fillStyle=c.color;
    switch(c.shape){
      case "circle": ctx.beginPath(); ctx.arc(0,0,c.r,0,Math.PI*2); ctx.fill(); break;
      case "square": ctx.fillRect(-c.r/2,-c.r/2,c.r,c.r); break;
      case "triangle": ctx.beginPath(); ctx.moveTo(0,-c.r); ctx.lineTo(c.r,c.r); ctx.lineTo(-c.r,c.r); ctx.closePath(); ctx.fill(); break;
      case "ribbon": ctx.beginPath(); ctx.ellipse(0,0,c.r*1.5,c.r/3,0,0,Math.PI*2); ctx.fill(); break;
    }
    ctx.restore();
  }
  function update(){
    for(let c of confetti){
      c.y+=c.d*7;
      c.x+=Math.sin(c.tiltAngle)*2;
      c.tiltAngle+=c.tiltAngleIncrement;
      c.rotation+=c.rotationSpeed;
      if(c.y>canvas.height+20){ c.y=-10; c.x=Math.random()*canvas.width; }
    }
  }
  let frame;
  function animate(){
    ctx.clearRect(0,0,canvas.width,canvas.height);
    confetti.forEach(draw); update();
    frame=requestAnimationFrame(animate);
  }
  animate();
  setTimeout(()=>{
    const fade=setInterval(()=>{
      opacity-=0.05;
      if(opacity<=0){ clearInterval(fade); cancelAnimationFrame(frame); ctx.clearRect(0,0,canvas.width,canvas.height); }
    },100);
  },7000);
}

// –ú—É–∑—ã–∫–∞ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏
window.addEventListener("beforeunload",()=>{ music.pause(); music.currentTime=0; });
document.addEventListener("visibilitychange",()=>{ if(document.hidden){ music.pause(); music.currentTime=0; } });

// Popup
function showPopup(msg){
  const popup=document.getElementById("popup");
  document.getElementById("popup-message").innerHTML=msg;
  popup.style.display="flex";
  popup.classList.remove("fade-out");
}
function closePopup(){ const popup=document.getElementById("popup"); popup.style.display="none"; }
</script>
</body>
</html>
